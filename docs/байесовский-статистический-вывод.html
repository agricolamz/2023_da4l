<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Байесовский статистический вывод | Анализ данных для лингвистов</title>
  <meta name="description" content="5 Байесовский статистический вывод | Анализ данных для лингвистов" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Байесовский статистический вывод | Анализ данных для лингвистов" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Байесовский статистический вывод | Анализ данных для лингвистов" />
  
  
  

<meta name="author" content="Г. А. Мороз" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="модели-смеси-распределений.html"/>
<link rel="next" href="байесовский-доверительный-интервал.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Анализ данных для лингвистов</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#используемые-пакеты"><i class="fa fa-check"></i><b>1.1</b> Используемые пакеты</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#домашние-задания"><i class="fa fa-check"></i><b>1.2</b> Домашние задания</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="распределения.html"><a href="распределения.html"><i class="fa fa-check"></i><b>2</b> Распределения</a>
<ul>
<li class="chapter" data-level="2.1" data-path="распределения.html"><a href="распределения.html#распределения-в-r"><i class="fa fa-check"></i><b>2.1</b> Распределения в R</a></li>
<li class="chapter" data-level="2.2" data-path="распределения.html"><a href="распределения.html#дискретные-переменные"><i class="fa fa-check"></i><b>2.2</b> Дискретные переменные</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="распределения.html"><a href="распределения.html#биномиальное-распределение"><i class="fa fa-check"></i><b>2.2.1</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="2.2.2" data-path="распределения.html"><a href="распределения.html#геометрическое-распределение"><i class="fa fa-check"></i><b>2.2.2</b> Геометрическое распределение</a></li>
<li class="chapter" data-level="2.2.3" data-path="распределения.html"><a href="распределения.html#распределение-пуассона"><i class="fa fa-check"></i><b>2.2.3</b> Распределение Пуассона</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="распределения.html"><a href="распределения.html#числовые-переменные"><i class="fa fa-check"></i><b>2.3</b> Числовые переменные</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="распределения.html"><a href="распределения.html#нормальное-распределение"><i class="fa fa-check"></i><b>2.3.1</b> Нормальное распределение</a></li>
<li class="chapter" data-level="2.3.2" data-path="распределения.html"><a href="распределения.html#логнормальное-распределение"><i class="fa fa-check"></i><b>2.3.2</b> Логнормальное распределение</a></li>
<li class="chapter" data-level="2.3.3" data-path="распределения.html"><a href="распределения.html#что-еще-почитать-про-распределения"><i class="fa fa-check"></i><b>2.3.3</b> Что еще почитать про распределения?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html"><i class="fa fa-check"></i><b>3</b> Метод максимального правдоподобия</a>
<ul>
<li class="chapter" data-level="3.1" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#оценка-вероятности"><i class="fa fa-check"></i><b>3.1</b> Оценка вероятности</a></li>
<li class="chapter" data-level="3.2" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#функция-правдоподобия"><i class="fa fa-check"></i><b>3.2</b> Функция правдоподобия</a></li>
<li class="chapter" data-level="3.3" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#пример-с-непрерывным-распределением"><i class="fa fa-check"></i><b>3.3</b> Пример с непрерывным распределением</a></li>
<li class="chapter" data-level="3.4" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#метод-максимального-правдоподобия-mle"><i class="fa fa-check"></i><b>3.4</b> Метод максимального правдоподобия (MLE)</a></li>
<li class="chapter" data-level="3.5" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#логорифм-функции-правдоподобия"><i class="fa fa-check"></i><b>3.5</b> Логорифм функции правдоподобия</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html"><i class="fa fa-check"></i><b>4</b> Модели смеси распределений</a>
<ul>
<li class="chapter" data-level="4.1" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#cмеси-распределений"><i class="fa fa-check"></i><b>4.1</b> Cмеси распределений</a></li>
<li class="chapter" data-level="4.2" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#модели-смеси-распределений-1"><i class="fa fa-check"></i><b>4.2</b> Модели смеси распределений</a></li>
<li class="chapter" data-level="4.3" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#несколько-замечаний"><i class="fa fa-check"></i><b>4.3</b> Несколько замечаний</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html"><i class="fa fa-check"></i><b>5</b> Байесовский статистический вывод</a>
<ul>
<li class="chapter" data-level="5.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#нотация"><i class="fa fa-check"></i><b>5.1</b> Нотация</a></li>
<li class="chapter" data-level="5.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#категориальный-пример"><i class="fa fa-check"></i><b>5.2</b> Категориальный пример</a></li>
<li class="chapter" data-level="5.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#разница-между-фриквентиским-и-байесовским-подходами"><i class="fa fa-check"></i><b>5.3</b> Разница между фриквентиским и байесовским подходами</a></li>
<li class="chapter" data-level="5.4" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#биномиальные-данные"><i class="fa fa-check"></i><b>5.4</b> Биномиальные данные</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#биномиальное-распределение-1"><i class="fa fa-check"></i><b>5.4.1</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="5.4.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#бета-распределение"><i class="fa fa-check"></i><b>5.4.2</b> Бета распределение</a></li>
<li class="chapter" data-level="5.4.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных"><i class="fa fa-check"></i><b>5.4.3</b> Байесовский апдейт биномиальных данных</a></li>
<li class="chapter" data-level="5.4.4" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных-несколько-моделей"><i class="fa fa-check"></i><b>5.4.4</b> Байесовский апдейт биномиальных данных: несколько моделей</a></li>
<li class="chapter" data-level="5.4.5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#что-почитать"><i class="fa fa-check"></i><b>5.4.5</b> Что почитать?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения"><i class="fa fa-check"></i><b>5.5</b> Байесовский апдейт нормального распределения</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-выбор-из-нескольких-моделей"><i class="fa fa-check"></i><b>5.5.1</b> Байесовский апдейт нормального распределения: выбор из нескольких моделей</a></li>
<li class="chapter" data-level="5.5.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-непрерывный-вариант"><i class="fa fa-check"></i><b>5.5.2</b> Байесовский апдейт нормального распределения: непрерывный вариант</a></li>
<li class="chapter" data-level="5.5.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#что-почитать-1"><i class="fa fa-check"></i><b>5.5.3</b> Что почитать?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#другие-распределения"><i class="fa fa-check"></i><b>5.6</b> Другие распределения</a></li>
<li class="chapter" data-level="5.7" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#вопросы-к-апостериорному-распределению"><i class="fa fa-check"></i><b>5.7</b> Вопросы к апостериорному распределению</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html"><i class="fa fa-check"></i><b>6</b> Байесовский доверительный интервал</a>
<ul>
<li class="chapter" data-level="6.1" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html#фреквентисткий-доверительный-интервал"><i class="fa fa-check"></i><b>6.1</b> Фреквентисткий доверительный интервал</a></li>
<li class="chapter" data-level="6.2" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html#байесовский-доверительный-интервал-1"><i class="fa fa-check"></i><b>6.2</b> Байесовский доверительный интервал</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html"><i class="fa fa-check"></i><b>7</b> Коэффициент Байеса</a>
<ul>
<li class="chapter" data-level="7.1" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#формула-байеса-опять"><i class="fa fa-check"></i><b>7.1</b> Формула Байеса опять</a></li>
<li class="chapter" data-level="7.2" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#категориальные-данные"><i class="fa fa-check"></i><b>7.2</b> Категориальные данные</a></li>
<li class="chapter" data-level="7.3" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#интерпретация-коэфициента-байеса"><i class="fa fa-check"></i><b>7.3</b> Интерпретация коэфициента Байеса</a></li>
<li class="chapter" data-level="7.4" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#биномиальные-данные-1"><i class="fa fa-check"></i><b>7.4</b> Биномиальные данные</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="эмпирическая-байесовская-оценка.html"><a href="эмпирическая-байесовская-оценка.html"><i class="fa fa-check"></i><b>8</b> Эмпирическая байесовская оценка</a></li>
<li class="chapter" data-level="9" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html"><i class="fa fa-check"></i><b>9</b> Введение в Марковские цепи Монте-Карло</a>
<ul>
<li class="chapter" data-level="9.1" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#марковские-цепи"><i class="fa fa-check"></i><b>9.1</b> Марковские цепи</a></li>
<li class="chapter" data-level="9.2" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#хакерская-статистика-основано-на-статистика-для-хакеров-джейка-вандерпласа"><i class="fa fa-check"></i><b>9.2</b> Хакерская статистика (основано на “Статистика для хакеров” Джейка Вандерпласа)</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#биномиальные-данные-2"><i class="fa fa-check"></i><b>9.2.1</b> Биномиальные данные</a></li>
<li class="chapter" data-level="9.2.2" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#метод-монте-карло"><i class="fa fa-check"></i><b>9.2.2</b> Метод Монте-Карло</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#соединение-идей-марковских-цепей-и-монте-карло"><i class="fa fa-check"></i><b>9.3</b> Соединение идей Марковских цепей и Монте-Карло</a></li>
<li class="chapter" data-level="9.4" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#brms"><i class="fa fa-check"></i><b>9.4</b> <code>brms</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="введение-в-марковские-цепи-монте-карло.html"><a href="введение-в-марковские-цепи-монте-карло.html#регрессионный-пример"><i class="fa fa-check"></i><b>9.4.1</b> Регрессионный пример</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html"><i class="fa fa-check"></i><b>10</b> Ограничения на применение регрессии</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#основы-регрессионного-анализа"><i class="fa fa-check"></i><b>10.1</b> Основы регрессионного анализа</a></li>
<li class="chapter" data-level="10.2" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#нелинейность-взаимосвязи"><i class="fa fa-check"></i><b>10.2</b> Нелинейность взаимосвязи</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#логарифмирование"><i class="fa fa-check"></i><b>10.2.1</b> Логарифмирование</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#нормальность-распределение-остатков"><i class="fa fa-check"></i><b>10.3</b> Нормальность распределение остатков</a></li>
<li class="chapter" data-level="10.4" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#гетероскидастичность"><i class="fa fa-check"></i><b>10.4</b> Гетероскидастичность</a></li>
<li class="chapter" data-level="10.5" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#мультиколлинеарность"><i class="fa fa-check"></i><b>10.5</b> Мультиколлинеарность</a></li>
<li class="chapter" data-level="10.6" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#независимость-наблюдений"><i class="fa fa-check"></i><b>10.6</b> Независимость наблюдений</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#линейная-модель-со-смешанными-эффектами"><i class="fa fa-check"></i><b>10.6.1</b> Линейная модель со смешанными эффектами</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html"><i class="fa fa-check"></i><b>11</b> Байесовский регрессионный анализ</a>
<ul>
<li class="chapter" data-level="11.1" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#основы-регрессионного-анализа-1"><i class="fa fa-check"></i><b>11.1</b> Основы регрессионного анализа</a></li>
<li class="chapter" data-level="11.2" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#brms-1"><i class="fa fa-check"></i><b>11.2</b> <code>brms</code></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#модель-только-со-свободным-членом"><i class="fa fa-check"></i><b>11.2.1</b> Модель только со свободным членом</a></li>
<li class="chapter" data-level="11.2.2" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#модель-только-с-угловым-коэффициентом"><i class="fa fa-check"></i><b>11.2.2</b> Модель только с угловым коэффициентом</a></li>
<li class="chapter" data-level="11.2.3" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#модель-с-угловым-коэффициентом-и-свободным-членом"><i class="fa fa-check"></i><b>11.2.3</b> Модель с угловым коэффициентом и свободным членом</a></li>
<li class="chapter" data-level="11.2.4" data-path="байесовский-регрессионный-анализ.html"><a href="байесовский-регрессионный-анализ.html#модель-со-смешанными-эффектами"><i class="fa fa-check"></i><b>11.2.4</b> Модель со смешанными эффектами</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Анализ данных для лингвистов</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="байесовский-статистический-вывод" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Байесовский статистический вывод<a href="байесовский-статистический-вывод.html#байесовский-статистический-вывод" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="нотация" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Нотация<a href="байесовский-статистический-вывод.html#нотация" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В байесовском подходе статистический вывод описывается формулой Байеса</p>
<p><span class="math display">\[P(θ|Data) = \frac{P(Data|θ)\times P(θ)}{P(Data)}\]</span></p>
<ul>
<li><span class="math inline">\(P(θ|Data)\)</span> — апостериорная вероятность (posterior)</li>
<li><span class="math inline">\(P(Data|θ)\)</span> — функция правдоподобия (likelihood)</li>
<li><span class="math inline">\(P(θ)\)</span> — априорная вероятность (prior)</li>
<li><span class="math inline">\(P(Data)\)</span> — нормализующий делитель</li>
</ul>
<p>В литературе можно еще встретить такую запись:</p>
<p><span class="math display">\[P(θ|Data) \propto P(Data|θ)\times P(θ)\]</span></p>
<p>На прошлых занятиях мы говорили, что <a href="https://stats.stackexchange.com/a/31241/225843">функция правдоподобия не обязана интегрироваться до 1</a>, тогда почему, назвав часть формулы Байеса <span class="math inline">\(P(Data|θ)\)</span> функцией правдоподобия, мы оставляем нотацию, будто это функция вероятностей? Потому что это условная вероятность, <a href="https://stats.stackexchange.com/q/448852/225843">она не обязана интегрироваться до 1</a>.</p>
</div>
<div id="категориальный-пример" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Категориальный пример<a href="байесовский-статистический-вывод.html#категориальный-пример" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Для примера я взял датасет, который содержит спамерские и обычные смс-сообщения, выложенный UCI Machine Learning <a href="https://www.kaggle.com/uciml/sms-spam-collection-dataset">на kaggle</a> и при помощи пакета <code>udpipe</code> токенизировал и определил часть речи:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="байесовский-статистический-вывод.html#cb70-1" aria-hidden="true" tabindex="-1"></a>sms_pos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/agricolamz/2022_da4l/master/data/spam_sms_pos.csv&quot;</span>)</span>
<span id="cb70-2"><a href="байесовский-статистический-вывод.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sms_pos)</span></code></pre></div>
<pre><code>Rows: 34
Columns: 3
$ type &lt;chr&gt; &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;ham&quot;, &quot;h…
$ upos &lt;chr&gt; &quot;ADJ&quot;, &quot;ADP&quot;, &quot;ADV&quot;, &quot;AUX&quot;, &quot;CCONJ&quot;, &quot;DET&quot;, &quot;INTJ&quot;, &quot;NOUN&quot;, &quot;NUM&quot;…
$ n    &lt;dbl&gt; 4329, 5004, 5832, 5707, 1607, 3493, 1676, 12842, 1293, 2424, 1144…</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="байесовский-статистический-вывод.html#cb72-1" aria-hidden="true" tabindex="-1"></a>sms_pos <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="байесовский-статистический-вывод.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="байесовский-статистический-вывод.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb72-4"><a href="байесовский-статистический-вывод.html#cb72-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">upos =</span> <span class="fu">fct_reorder</span>(upos, n, mean, <span class="at">.desc =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="байесовский-статистический-вывод.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(type, ratio))<span class="sc">+</span></span>
<span id="cb72-6"><a href="байесовский-статистический-вывод.html#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb72-7"><a href="байесовский-статистический-вывод.html#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(ratio, <span class="dv">3</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb72-8"><a href="байесовский-статистический-вывод.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>upos, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-63-1.png" width="864" /></p>
<p>Давайте полученные доли считать нашей моделью: сумма всех чисел внутри каждого типа (<code>ham</code>/<code>spam</code>) дает в сумме 1. Мы получили новое сообщение:</p>
<blockquote>
<p>Call FREEPHONE 0800 542 0825 now!</p>
</blockquote>
<p>Модель <code>udpipe</code> разобрала его следующим образом:</p>
<blockquote>
<p>VERB NUM NUM NUM NUM ADV PUNCT</p>
</blockquote>
<p>Понятно, что это – спам, но мы попытаемся применить байесовский статистический вывод, чтобы определить тип сообщения. Предположим, что машина считает обе гипотезы равновероятными, т. е. ее априорное распределение гипотез равно 0.5 каждая. На минуту представим, что машина анализирует текст пословно. Первое слово типа <code>VERB</code>. Функции правдоподобия равны 0.135 и 0.096 для сообщений типа <code>ham</code> и <code>spam</code> соответственно. Применим байесовский апдейт:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="байесовский-статистический-вывод.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;ham&quot;</span>, <span class="st">&quot;spam&quot;</span>),</span>
<span id="cb73-2"><a href="байесовский-статистический-вывод.html#cb73-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fl">0.5</span>,</span>
<span id="cb73-3"><a href="байесовский-статистический-вывод.html#cb73-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood =</span> <span class="fu">c</span>(<span class="fl">0.135</span>, <span class="fl">0.096</span>),</span>
<span id="cb73-4"><a href="байесовский-статистический-вывод.html#cb73-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">product =</span> prior<span class="sc">*</span>likelihood,</span>
<span id="cb73-5"><a href="байесовский-статистический-вывод.html#cb73-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior =</span> product<span class="sc">/</span><span class="fu">sum</span>(product))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prior"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["product"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["posterior"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"ham","2":"0.5","3":"0.135","4":"0.0675","5":"0.5844156"},{"1":"spam","2":"0.5","3":"0.096","4":"0.0480","5":"0.4155844"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Вот мы и сделали байесовский апдейт. Теперь апостериорное распределение, которое мы получили на предыдущем шаге, мы можем использовать в новом апдейте. Следующее слово в сообщении типа <code>NUM</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="байесовский-статистический-вывод.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;ham&quot;</span>, <span class="st">&quot;spam&quot;</span>),</span>
<span id="cb74-2"><a href="байесовский-статистический-вывод.html#cb74-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior_2 =</span> <span class="fu">c</span>(<span class="fl">0.584</span>, <span class="fl">0.416</span>),</span>
<span id="cb74-3"><a href="байесовский-статистический-вывод.html#cb74-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood_2 =</span> <span class="fu">c</span>(<span class="fl">0.016</span>, <span class="fl">0.117</span>),</span>
<span id="cb74-4"><a href="байесовский-статистический-вывод.html#cb74-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">product_2 =</span> prior_2<span class="sc">*</span>likelihood_2,</span>
<span id="cb74-5"><a href="байесовский-статистический-вывод.html#cb74-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior_2 =</span> product_2<span class="sc">/</span><span class="fu">sum</span>(product_2))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prior_2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood_2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["product_2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["posterior_2"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"ham","2":"0.584","3":"0.016","4":"0.009344","5":"0.161059"},{"1":"spam","2":"0.416","3":"0.117","4":"0.048672","5":"0.838941"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Уже на второй итерации, наша модель почти уверена, что это сообщение <code>spam</code>. На третьей итерации уверенность только растет:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="байесовский-статистический-вывод.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;ham&quot;</span>, <span class="st">&quot;spam&quot;</span>),</span>
<span id="cb75-2"><a href="байесовский-статистический-вывод.html#cb75-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior_3 =</span> <span class="fu">c</span>(<span class="fl">0.161</span>, <span class="fl">0.839</span>),</span>
<span id="cb75-3"><a href="байесовский-статистический-вывод.html#cb75-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood_3 =</span> <span class="fu">c</span>(<span class="fl">0.016</span>, <span class="fl">0.117</span>),</span>
<span id="cb75-4"><a href="байесовский-статистический-вывод.html#cb75-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">product_3 =</span> prior_3<span class="sc">*</span>likelihood_3,</span>
<span id="cb75-5"><a href="байесовский-статистический-вывод.html#cb75-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior_3 =</span> product_3<span class="sc">/</span><span class="fu">sum</span>(product_3))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prior_3"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood_3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["product_3"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["posterior_3"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"ham","2":"0.161","3":"0.016","4":"0.002576","5":"0.02557103"},{"1":"spam","2":"0.839","3":"0.117","4":"0.098163","5":"0.97442897"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="rmdtask">
<p>
На основе первых трех слов посчитайте посчитайте вероятность
гипотезы, что перед нами спамерское сообщение, если предположить, что
каждое пятое сообщение – спам. Ответ округлите до трех знаков после
запятой.
</p>
</div>
<form name="form_61605" onsubmit="return validate_form_61605()" method="post">
<input type="text" name="answer_61605"><br><input type="submit" value="check">
</form>
<p id="result_61605">
</p>
<script> function validate_form_61605() {var x, text; var x = document.forms["form_61605"]["answer_61605"].value;if (x == "0.905"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_61605').innerHTML = text; return false;} </script>
<p>Из формулы Байеса следует, что не обязательно каждый раз делить на нормализующий делитель, это можно сделать единожды.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="байесовский-статистический-вывод.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;ham&quot;</span>, <span class="st">&quot;spam&quot;</span>),</span>
<span id="cb76-2"><a href="байесовский-статистический-вывод.html#cb76-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fl">0.5</span>,</span>
<span id="cb76-3"><a href="байесовский-статистический-вывод.html#cb76-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood =</span> <span class="fu">c</span>(<span class="fl">0.135</span>, <span class="fl">0.096</span>),</span>
<span id="cb76-4"><a href="байесовский-статистический-вывод.html#cb76-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood_2 =</span> <span class="fu">c</span>(<span class="fl">0.016</span>, <span class="fl">0.117</span>),</span>
<span id="cb76-5"><a href="байесовский-статистический-вывод.html#cb76-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">product =</span> prior<span class="sc">*</span>likelihood<span class="sc">*</span>likelihood_2<span class="sc">*</span>likelihood_2,</span>
<span id="cb76-6"><a href="байесовский-статистический-вывод.html#cb76-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior =</span> product<span class="sc">/</span><span class="fu">sum</span>(product))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prior"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["likelihood_2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["product"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["posterior"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"ham","2":"0.5","3":"0.135","4":"0.016","5":"0.000017280","6":"0.0256246"},{"1":"spam","2":"0.5","3":"0.096","4":"0.117","5":"0.000657072","6":"0.9743754"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Из приведенных рассуждений также следует, что все равно в каком порядке мы производим байесовский апдейт: мы могли сначала умножить на значение правдоподобия для категории <code>NUM</code> и лишь в конце на значение правдоподобия <code>VERB</code>.</p>
<p>Также стоит отметить, что если данных много, то через какое-то время становится все равно, какое у нас было априорное распределение. Даже в нашем примере, в котором мы проанализировали первые три слова сообщения, модель, прогнозирующая, что сообщение спамерское, выиграет, даже если, согласно априорному распределению, спамерским является каждое 20 сообщение:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="байесовский-статистический-вывод.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;ham&quot;</span>, <span class="st">&quot;spam&quot;</span>),</span>
<span id="cb77-2"><a href="байесовский-статистический-вывод.html#cb77-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.05</span>),</span>
<span id="cb77-3"><a href="байесовский-статистический-вывод.html#cb77-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood =</span> <span class="fu">c</span>(<span class="fl">0.135</span>, <span class="fl">0.096</span>),</span>
<span id="cb77-4"><a href="байесовский-статистический-вывод.html#cb77-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">likelihood_2 =</span> <span class="fu">c</span>(<span class="fl">0.016</span>, <span class="fl">0.117</span>),</span>
<span id="cb77-5"><a href="байесовский-статистический-вывод.html#cb77-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">product =</span> prior<span class="sc">*</span>likelihood<span class="sc">*</span>likelihood_2<span class="sc">*</span>likelihood_2,</span>
<span id="cb77-6"><a href="байесовский-статистический-вывод.html#cb77-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior =</span> product<span class="sc">/</span><span class="fu">sum</span>(product))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prior"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["likelihood_2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["product"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["posterior"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"ham","2":"0.95","3":"0.135","4":"0.016","5":"0.0000328320","6":"0.3331872"},{"1":"spam","2":"0.05","3":"0.096","4":"0.117","5":"0.0000657072","6":"0.6668128"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Самым главным отличием байесовского статистического вывода от фриквентистского, является то, что мы в результате получаем вероятность каждой из моделей. Это очень значительно отличается от фриквентистской практики нулевых гипотез и p-value, в соответствии с которыми мы можем лишь отвергнуть или не отвергнуть нулевую гипотезу.</p>
<div class="rmdtask">
<p>
Вашего друга похитили а на почту отправили <a
href="https://raw.githubusercontent.com/agricolamz/2022_da4l/master/data/weather.csv">датасет</a>,
в котором записаны данные о погоде из пяти городов. Ваш телефон
зазвонил, и друг сказал, что не знает куда его похитили, но за окном
легкий дождь (<code>Rain</code>). А в какой-то из следующих дней —
сильный дождь (<code>Rain, Thunderstorm</code>). Исходя из явно
неверного предположения, что погодные условия каждый день не зависят
друг от друга, сделайте байесовский апдейт и предположите, в какой город
вероятнее всего похитили друга.
</p>
</div>
<form name="form_73236" onsubmit="return validate_form_73236()" method="post">
<select name="answer_73236"><option> Auckland </option><option> Beijing </option><option> Chicago </option><option> Mumbai </option><option> San Diego </option></select><br><input type="submit" value="check">
</form>
<p id="result_73236">
</p>
<script> function validate_form_73236() {var x, text; var x = document.forms["form_73236"]["answer_73236"].value;if (x == "San Diego"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_73236').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите получившуюся вероятность. Выполняя задание, округлите все
вероятности и значения правдоподобия до 3 знаков после запятой.
</p>
</div>
<form name="form_9091" onsubmit="return validate_form_9091()" method="post">
<input type="text" name="answer_9091"><br><input type="submit" value="check">
</form>
<p id="result_9091">
</p>
<script> function validate_form_9091() {var x, text; var x = document.forms["form_9091"]["answer_9091"].value;if (x == "0.549"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_9091').innerHTML = text; return false;} </script>
</div>
<div id="разница-между-фриквентиским-и-байесовским-подходами" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Разница между фриквентиским и байесовским подходами<a href="байесовский-статистический-вывод.html#разница-между-фриквентиским-и-байесовским-подходами" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/gelman.png" /></p>
<p>Картинка из одной из моих любимых книг по статистике <span class="citation">(<a href="#ref-efron16" role="doc-biblioref">Efron and Hastie 2016</a>: 34)</span>.</p>
</div>
<div id="биномиальные-данные" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Биномиальные данные<a href="байесовский-статистический-вывод.html#биномиальные-данные" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Биномиальные данные возникают, когда нас интересует доля успехов в какой-то серии эксперементов Бернулли.</p>
<div id="биномиальное-распределение-1" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Биномиальное распределение<a href="байесовский-статистический-вывод.html#биномиальное-распределение-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Биномиальное распределение — распределение количества успехов эксперементов Бернулли из <em>n</em> попыток с вероятностью успеха <em>p</em>.</p>
<p><span class="math display">\[P(k | n, p) = \frac{n!}{k!(n-k)!} \times p^k \times (1-p)^{n-k} =  {n \choose k} \times p^k \times (1-p)^{n-k}\]</span>
<span class="math display">\[ 0 \leq p \leq 1; n, k &gt; 0\]</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="байесовский-статистический-вывод.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>,</span>
<span id="cb78-2"><a href="байесовский-статистический-вывод.html#cb78-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">density =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> x, <span class="at">size =</span> <span class="dv">50</span>, <span class="at">prob =</span> <span class="fl">0.16</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="байесовский-статистический-вывод.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, density))<span class="sc">+</span></span>
<span id="cb78-4"><a href="байесовский-статистический-вывод.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb78-5"><a href="байесовский-статистический-вывод.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb78-6"><a href="байесовский-статистический-вывод.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Биномиальное распределение p = 0.16, n = 50&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
<div id="бета-распределение" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Бета распределение<a href="байесовский-статистический-вывод.html#бета-распределение" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[P(x; α, β) = \frac{x^{α-1}\times (1-x)^{β-1}}{B(α, β)}; 0 \leq x \leq 1; α, β &gt; 0\]</span></p>
<p>Бета функция:</p>
<p><span class="math display">\[Β(α, β) = \frac{Γ(α)\times Γ(β)}{Γ(α+β)} = \frac{(α-1)!(β-1)!}{(α+β-1)!} \]</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="байесовский-статистический-вывод.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb79-2"><a href="байесовский-статистический-вывод.html#cb79-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">density =</span> <span class="fu">dbeta</span>(<span class="at">x =</span> x, <span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="dv">42</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="байесовский-статистический-вывод.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, density))<span class="sc">+</span></span>
<span id="cb79-4"><a href="байесовский-статистический-вывод.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb79-5"><a href="байесовский-статистический-вывод.html#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb79-6"><a href="байесовский-статистический-вывод.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Бета распределение α = 8, β = 42&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Можно поиграть с разными параметрами:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="байесовский-статистический-вывод.html#cb80-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;agricolamz/beta_distribution_shiny&quot;</span>) </span></code></pre></div>
<p><span class="math display">\[\mu = \frac{\alpha}{\alpha+\beta}\]</span></p>
<p><span class="math display">\[\sigma^2 = \frac{\alpha\times\beta}{(\alpha+\beta)^2\times(\alpha+\beta+1)}\]</span></p>
</div>
<div id="байесовский-апдейт-биномиальных-данных" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Байесовский апдейт биномиальных данных<a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[Beta_{post}(\alpha_{post}, \beta_{post}) = Beta(\alpha_{prior}+\alpha_{data}, \beta_{prior}+\beta_{data}),\]</span>
где <span class="math inline">\(Beta\)</span> — это бета распределение</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="байесовский-статистический-вывод.html#cb81-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;agricolamz/bayes_for_binomial_app&quot;</span>) </span></code></pre></div>
<div class="rmdtask">
<p>
Немного упрощая данные из статьи <span class="citation"><span class="citation">(<a href="#ref-rosenbach03" role="doc-biblioref">Rosenbach 2003</a>: 394)</span></span>, можно сказать что носители
британского английского предпочитают <em>s</em>-генитив (90%)
<em>of</em>-генитиву (10%). Проведите байесовский апдейт, если Вы
наблюдаете в интервью британского актера из 120 контекстов 92
<em>s</em>-генитивов. Априорное распределение берите соразмерное данным.
Ответ округлите до трёх или менее знаков после запятой.
</p>
</div>
<div class="rmdtask">
<p>
Параметр альфа:
</p>
</div>
<form name="form_62041" onsubmit="return validate_form_62041()" method="post">
<input type="text" name="answer_62041"><br><input type="submit" value="check">
</form>
<p id="result_62041">
</p>
<script> function validate_form_62041() {var x, text; var x = document.forms["form_62041"]["answer_62041"].value;if (x == "200"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_62041').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Параметр бета:
</p>
</div>
<form name="form_33700" onsubmit="return validate_form_33700()" method="post">
<input type="text" name="answer_33700"><br><input type="submit" value="check">
</form>
<p id="result_33700">
</p>
<script> function validate_form_33700() {var x, text; var x = document.forms["form_33700"]["answer_33700"].value;if (x == "40"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_33700').innerHTML = text; return false;} </script>
</div>
<div id="байесовский-апдейт-биномиальных-данных-несколько-моделей" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Байесовский апдейт биномиальных данных: несколько моделей<a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных-несколько-моделей" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="байесовский-статистический-вывод.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">6</span>),</span>
<span id="cb82-2"><a href="байесовский-статистический-вывод.html#cb82-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">density =</span> <span class="fu">c</span>(<span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="dv">42</span>),</span>
<span id="cb82-3"><a href="байесовский-статистический-вывод.html#cb82-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">16</span>, <span class="at">shape2 =</span> <span class="dv">34</span>),</span>
<span id="cb82-4"><a href="байесовский-статистический-вывод.html#cb82-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">24</span>, <span class="at">shape2 =</span> <span class="dv">26</span>),</span>
<span id="cb82-5"><a href="байесовский-статистический-вывод.html#cb82-5" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">8</span><span class="sc">+</span><span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">42</span><span class="sc">+</span><span class="dv">16</span>),</span>
<span id="cb82-6"><a href="байесовский-статистический-вывод.html#cb82-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">16</span><span class="sc">+</span><span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">34</span><span class="sc">+</span><span class="dv">16</span>),</span>
<span id="cb82-7"><a href="байесовский-статистический-вывод.html#cb82-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dbeta</span>(<span class="fu">unique</span>(x), <span class="at">shape1 =</span> <span class="dv">24</span><span class="sc">+</span><span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">26</span><span class="sc">+</span><span class="dv">16</span>)),</span>
<span id="cb82-8"><a href="байесовский-статистический-вывод.html#cb82-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;prior&quot;</span>, <span class="st">&quot;prior&quot;</span>, <span class="st">&quot;posterior&quot;</span>, <span class="st">&quot;posterior&quot;</span>, <span class="st">&quot;posterior&quot;</span>), <span class="at">each =</span> <span class="dv">100</span>),</span>
<span id="cb82-9"><a href="байесовский-статистический-вывод.html#cb82-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">dataset =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;prior: 8, 42&quot;</span>, <span class="st">&quot;prior: 16, 34&quot;</span>, <span class="st">&quot;prior: 24, 26&quot;</span>,</span>
<span id="cb82-10"><a href="байесовский-статистический-вывод.html#cb82-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;prior: 8, 42&quot;</span>, <span class="st">&quot;prior: 16, 34&quot;</span>, <span class="st">&quot;prior: 24, 26&quot;</span>), <span class="at">each =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-11"><a href="байесовский-статистический-вывод.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, density, <span class="at">color =</span> type))<span class="sc">+</span></span>
<span id="cb82-12"><a href="байесовский-статистический-вывод.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb82-13"><a href="байесовский-статистический-вывод.html#cb82-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dataset)<span class="sc">+</span></span>
<span id="cb82-14"><a href="байесовский-статистический-вывод.html#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;data = 4, 16&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<div id="что-почитать" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Что почитать?<a href="байесовский-статистический-вывод.html#что-почитать" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Если остались неясности, то можно посмотреть 2-ую главу <span class="citation">(<a href="#ref-robinson17" role="doc-biblioref">Robinson 2017</a>)</span>.</p>
</div>
</div>
<div id="байесовский-апдейт-нормального-распределения" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Байесовский апдейт нормального распределения<a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Встроенный датасет <code>ChickWeight</code> содержит вес цыплят (<code>weight</code>) в зависимости от типа диеты (<code>Diet</code>). Мы будем анализировать 20-дневных птенцов.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="байесовский-статистический-вывод.html#cb83-1" aria-hidden="true" tabindex="-1"></a>ChickWeight <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="байесовский-статистический-вывод.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Time <span class="sc">==</span> <span class="dv">20</span>) <span class="ot">-&gt;</span></span>
<span id="cb83-3"><a href="байесовский-статистический-вывод.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  chicks</span>
<span id="cb83-4"><a href="байесовский-статистический-вывод.html#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="байесовский-статистический-вывод.html#cb83-5" aria-hidden="true" tabindex="-1"></a>chicks <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="байесовский-статистический-вывод.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight))<span class="sc">+</span></span>
<span id="cb83-7"><a href="байесовский-статистический-вывод.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>Начнем с апостериорных параметров для наблюдений <span class="math inline">\(x_1, ... x_n\)</span> со средним <span class="math inline">\(\mu_{data}\)</span> известной дисперсией <span class="math inline">\(\sigma_{known}^2\)</span></p>
<div id="байесовский-апдейт-нормального-распределения-выбор-из-нескольких-моделей" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Байесовский апдейт нормального распределения: выбор из нескольких моделей<a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-выбор-из-нескольких-моделей" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Мы можем рассматривать эту задачу как выбор между несколькими моделями с разными средними:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="байесовский-статистический-вывод.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>, <span class="dv">6</span>),</span>
<span id="cb84-2"><a href="байесовский-статистический-вывод.html#cb84-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">density =</span> <span class="fu">c</span>(<span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">125</span>, <span class="at">sd =</span> <span class="dv">70</span>),</span>
<span id="cb84-3"><a href="байесовский-статистический-вывод.html#cb84-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd =</span> <span class="dv">70</span>),</span>
<span id="cb84-4"><a href="байесовский-статистический-вывод.html#cb84-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">175</span>, <span class="at">sd =</span> <span class="dv">70</span>),</span>
<span id="cb84-5"><a href="байесовский-статистический-вывод.html#cb84-5" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">70</span>),</span>
<span id="cb84-6"><a href="байесовский-статистический-вывод.html#cb84-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">225</span>, <span class="at">sd =</span> <span class="dv">70</span>),</span>
<span id="cb84-7"><a href="байесовский-статистический-вывод.html#cb84-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">dnorm</span>(<span class="fu">unique</span>(x), <span class="at">mean =</span> <span class="dv">250</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb84-8"><a href="байесовский-статистический-вывод.html#cb84-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">dataset =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">each =</span> <span class="dv">400</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-9"><a href="байесовский-статистический-вывод.html#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, density, <span class="at">color =</span> <span class="fu">factor</span>(dataset)))<span class="sc">+</span></span>
<span id="cb84-10"><a href="байесовский-статистический-вывод.html#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>Дальше мы можем точно так же апдейтить, как мы делали раньше:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="байесовский-статистический-вывод.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mu =</span> <span class="fu">seq</span>(<span class="dv">125</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">25</span>),</span>
<span id="cb85-2"><a href="байесовский-статистический-вывод.html#cb85-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,</span>
<span id="cb85-3"><a href="байесовский-статистический-вывод.html#cb85-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood =</span> <span class="fu">c</span>(<span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">125</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb85-4"><a href="байесовский-статистический-вывод.html#cb85-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb85-5"><a href="байесовский-статистический-вывод.html#cb85-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">175</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb85-6"><a href="байесовский-статистический-вывод.html#cb85-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb85-7"><a href="байесовский-статистический-вывод.html#cb85-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">225</span>, <span class="at">sd =</span> <span class="dv">70</span>)),</span>
<span id="cb85-8"><a href="байесовский-статистический-вывод.html#cb85-8" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">prod</span>(<span class="fu">dnorm</span>(chicks<span class="sc">$</span>weight, <span class="at">mean =</span> <span class="dv">250</span>, <span class="at">sd =</span> <span class="dv">70</span>))),</span>
<span id="cb85-9"><a href="байесовский-статистический-вывод.html#cb85-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">product =</span> prior<span class="sc">*</span>likelihood,</span>
<span id="cb85-10"><a href="байесовский-статистический-вывод.html#cb85-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior =</span> product<span class="sc">/</span><span class="fu">sum</span>(product)) <span class="ot">-&gt;</span></span>
<span id="cb85-11"><a href="байесовский-статистический-вывод.html#cb85-11" aria-hidden="true" tabindex="-1"></a>  results</span>
<span id="cb85-12"><a href="байесовский-статистический-вывод.html#cb85-12" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mu"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["prior"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["likelihood"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["product"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["posterior"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"125","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002064365","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003440608","5":"0.000000000000002388819"},{"1":"150","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000047384329377338","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078973882295564","5":"0.000000054831688517382"},{"1":"175","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003078411340211131696","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005130685567018552452","5":"0.003562242917709386100"},{"1":"200","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000566059603710931659379","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000943432672851552765631","5":"0.655026762662052508546"},{"1":"225","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000294605789256285052085","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000491009648760475086808","5":"0.340908757899263947788"},{"1":"250","2":"0.1666667","3":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000433974280487837110","4":"0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000723290467479728469","5":"0.000502181689283212520"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="байесовский-статистический-вывод.html#cb86-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="байесовский-статистический-вывод.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mu, prior, posterior) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="байесовский-статистический-вывод.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;probability&quot;</span>, prior<span class="sc">:</span>posterior) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="байесовский-статистический-вывод.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mu, probability, <span class="at">color =</span> type))<span class="sc">+</span></span>
<span id="cb86-5"><a href="байесовский-статистический-вывод.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb86-6"><a href="байесовский-статистический-вывод.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;изменение вероятностей для каждой из моделей&quot;</span>,</span>
<span id="cb86-7"><a href="байесовский-статистический-вывод.html#cb86-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;μ&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
<div id="байесовский-апдейт-нормального-распределения-непрерывный-вариант" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Байесовский апдейт нормального распределения: непрерывный вариант<a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-непрерывный-вариант" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Во первых, нам понадобится некоторая мера, которая называется <em>точность</em> (precision):</p>
<p><span class="math display">\[\tau = \frac{1}{\sigma^2}\]</span></p>
<p><span class="math display">\[\tau_{post} = \tau_{prior} + \tau_{data} \Rightarrow \sigma^2_{post} = \frac{1}{\tau_{post}}\]</span></p>
<p><span class="math display">\[\mu_{post} = \frac{\mu_{prior} \times \tau_{prior} + \mu_{data} \times \tau_{data}}{\tau_{post}}\]</span></p>
<p>Так что если нашим априорным распределением мы назовем нормальное распределение со средним около 180 и стандартным отклонением 90, то процесс байесовского апдейта будет выглядеть вот так:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="байесовский-статистический-вывод.html#cb87-1" aria-hidden="true" tabindex="-1"></a>sd_prior <span class="ot">&lt;-</span> <span class="dv">90</span> </span>
<span id="cb87-2"><a href="байесовский-статистический-вывод.html#cb87-2" aria-hidden="true" tabindex="-1"></a>sd_data <span class="ot">&lt;-</span> <span class="fu">sd</span>(chicks<span class="sc">$</span>weight)</span>
<span id="cb87-3"><a href="байесовский-статистический-вывод.html#cb87-3" aria-hidden="true" tabindex="-1"></a>sd_post <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>sd_prior<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>sd_data<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-4"><a href="байесовский-статистический-вывод.html#cb87-4" aria-hidden="true" tabindex="-1"></a>mean_prior <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb87-5"><a href="байесовский-статистический-вывод.html#cb87-5" aria-hidden="true" tabindex="-1"></a>mean_data <span class="ot">&lt;-</span> <span class="fu">mean</span>(chicks<span class="sc">$</span>weight)</span>
<span id="cb87-6"><a href="байесовский-статистический-вывод.html#cb87-6" aria-hidden="true" tabindex="-1"></a>mean_post <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(<span class="fu">c</span>(mean_prior, mean_data), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sd_prior<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sd_data<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb87-7"><a href="байесовский-статистический-вывод.html#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="байесовский-статистический-вывод.html#cb87-8" aria-hidden="true" tabindex="-1"></a>chicks <span class="sc">%&gt;%</span> </span>
<span id="cb87-9"><a href="байесовский-статистический-вывод.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight)) <span class="sc">+</span></span>
<span id="cb87-10"><a href="байесовский-статистический-вывод.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb87-11"><a href="байесовский-статистический-вывод.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(mean_prior,  sd_prior), <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-12"><a href="байесовский-статистический-вывод.html#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(mean_post,  sd_post), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="байесовский-статистический-вывод.html#cb88-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">&quot;agricolamz/bayes_for_normal_app&quot;</span>) </span></code></pre></div>
<div class="rmdtask">
<p>
В работе <span class="citation"><span class="citation">(<a href="#ref-coretta2016" role="doc-biblioref">Coretta 2016</a>)</span></span> собраны <a
href="https://raw.githubusercontent.com/agricolamz/2022_da4l/master/data/Coretta_2017_icelandic.csv">данные</a>
длительности исландских гласных. Отфильтруйте данные, произнесенные
носителем <code>tt01</code> (переменная <code>speaker</code>),
произведите байесовский апдейт данных, моделируя длительность гласных
(переменная <code>vowel.dur</code>) нормальным распределением и
постройте график. В качестве априорного распределения используйте
нормальное распределение со средним 87 и стандартным отклонением 25.
</p>
</div>
<p><img src="da4l_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
<div id="что-почитать-1" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Что почитать?<a href="байесовский-статистический-вывод.html#что-почитать-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">Murphy K. P. (2007) Conjugate Bayesian analysis of the Gaussian distribution</a></li>
<li><a href="https://people.eecs.berkeley.edu/~jordan/courses/260-spring10/lectures/lecture5.pdf">Jordan M. I. (2010) The Conjugate Prior for the Normal Distribution</a></li>
<li>раздел 2.5 в Gelman A. et. al (2014) Bayesian Data Analysis</li>
</ul>
</div>
</div>
<div id="другие-распределения" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Другие распределения<a href="байесовский-статистический-вывод.html#другие-распределения" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Мы обсудили биномиальные и нормальнораспределенные данные. Так случилось, что для них есть короткий путь сделать байесовский апдейт, не применяя формулы байеса. И нам так повезло, что связки априорного/апосториорного распределений и функции правдоподобия такие простые:</p>
<ul>
<li>априорного/апосториорного распределены как бета распределение, значит функция правдоподобия – биномиальное распределение</li>
<li>если мы моделируем данные при помощи нормального распределения, то все три распределения (априорное, функция правдопдобия и апосториорное) – нормальные.</li>
</ul>
<p>Такие отношения между распределениями называют сопряженными (conjugate). В результате для разных семейств функции правдоподобия существует список соответствующих сопряженных априорных распределений (conjugate prior), который можно найти, например, <a href="https://en.wikipedia.org/wiki/Conjugate_prior">здесь</a>.</p>
<p>В более случаях используется (а на самом деле почти всегда) Марковские цепи Монте-Карло (MCMC).</p>
</div>
<div id="вопросы-к-апостериорному-распределению" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Вопросы к апостериорному распределению<a href="байесовский-статистический-вывод.html#вопросы-к-апостериорному-распределению" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>A frequentist uses impeccable logic to answer the wrong question, while a Bayesian answers the right question by making assumptions that nobody can fully believe in. (P. G. Hammer)</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>попытка оценить параметр θ и/или какой-нибудь интервал, в котором он лежит.
<ul>
<li>среднее апостериорного распределения (mean of the posterior estimation, MAP)</li>
<li>максимум апостериорного распределения (maximum a posteriori estimation, MAP)</li>
<li>байесовский доверительный интервал</li>
</ul></li>
<li>ответить на вопросы вроде
<ul>
<li>какова вероятность, что значение θ больше некоторого значения <span class="math inline">\(x\)</span>?</li>
<li>какова вероятность, что значение θ лежит в интервале <span class="math inline">\([x; y]\)</span>?</li>
<li>и т. п.</li>
</ul></li>
<li>Выборки из апостериорного распределения (Posterior simulation):
<ul>
<li>симулируйте большую выборку из апостериорного распределения;</li>
<li>используйте полученную выборку для статистического вывода.</li>
</ul></li>
</ol>
<p>Допустим, мы получили апостериорное бета распределение с параметрами 20 и 70. Какова вероятность наблюдать значения больше 0.3?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="байесовский-статистический-вывод.html#cb89-1" aria-hidden="true" tabindex="-1"></a>posterior_simulation <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="dv">20</span>, <span class="at">shape2 =</span> <span class="dv">70</span>)</span>
<span id="cb89-2"><a href="байесовский-статистический-вывод.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior_simulation <span class="sc">&gt;</span> <span class="fl">0.3</span>)<span class="sc">/</span><span class="dv">10000</span></span></code></pre></div>
<pre><code>[1] 0.0457</code></pre>
<p>И это не p-value! Это настоящие вероятности!</p>

</div>
</div>
<h3>Ссылки на литературу<a href="ссылки-на-литературу.html#ссылки-на-литературу" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-coretta2016" class="csl-entry">
Coretta, Stefano. 2016. <span>“Vowel Duration and Aspiration Effects in Icelandic.”</span> University of York.
</div>
<div id="ref-efron16" class="csl-entry">
Efron, Bradley, and Trevor Hastie. 2016. <em>Computer Age Statistical Inference</em>. Vol. 5. Cambridge University Press.
</div>
<div id="ref-robinson17" class="csl-entry">
Robinson, D. 2017. <em>Introduction to Empirical Bayes: Examples from Baseball Statistics</em>. ASIN: B06WP26J8Q.
</div>
<div id="ref-rosenbach03" class="csl-entry">
Rosenbach, Anette. 2003. <span>“Aspects of Iconicity and Economy in the Choice Between the <em>s-</em>Genitive and the <em>of-</em>Genitive in <span>E</span>nglish.”</span> In <em>Determinants of Grammatical Variation in English</em>, edited by Günter Rohdenburg and Britta Mondorf. Berlin, New York: Mouton de Gruyter.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="модели-смеси-распределений.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="байесовский-доверительный-интервал.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/2022_da4l/edit/master/04-intro-to-Bayes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["da4l.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
